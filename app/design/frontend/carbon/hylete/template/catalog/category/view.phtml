<?php
/**
 * Magento
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Academic Free License (AFL 3.0)
 * that is bundled with this package in the file LICENSE_AFL.txt.
 * It is also available through the world-wide-web at this URL:
 * http://opensource.org/licenses/afl-3.0.php
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@magentocommerce.com so we can send you a copy immediately.
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade Magento to newer
 * versions in the future. If you wish to customize Magento for your
 * needs please refer to http://www.magentocommerce.com for more information.
 *
 * @category    design
 * @package     base_default
 * @copyright   Copyright (c) 2012 Magento Inc. (http://www.magentocommerce.com)
 * @license     http://opensource.org/licenses/afl-3.0.php  Academic Free License (AFL 3.0)
 */
?>
<?php
/**
 * Category view template
 *
 * @see Mage_Catalog_Block_Category_View
 */
?>
<?php
    $_catalogHelper = $this->helper('catalog/output');
    $_helper = Mage::helper('hylete');
    $_category  = $this->getCurrentCategory();
    $_imageBaseUrl = Mage::getBaseUrl('media') . 'catalog/category/';

    $_name = $_catalogHelper->categoryAttribute($_category, $_category->getName(), 'name');
    $_description = $_category->getDescription();

    $_img = $_category->getImage();
    $_imgTablet = $_category->getImageTablet();
    $_imgMobile = $_category->getImageMobile();
    $_itemTitle = $this->escapeHtml($_img);
    $_inverted = ($_category->getInvert()) ? 'inverted' : '';
    $_alignText = 'align-' . $_helper->getCategoryAttributeLabel('align_text', $_category->getAlignText());
    $_textPlacement = 'placement-' . $_helper->getCategoryAttributeLabel('text_placement', $_category->getTextPlacement());

    $_imgMobile = ($_imgMobile) ? $_imgMobile : $_img;
    $_imgTablet = ($_imgTablet) ? $_imgTablet : $_img;
?>

<?php echo $this->getChildHtml('breadcrumbs') ?>

<div class="category-top">
    <?php echo $this->getMessagesBlock()->getGroupedHtml() ?>
    <header class="category-title">
        <?php if($this->IsRssCatalogEnable() && $this->IsTopCategory()): ?>
            <a href="<?php echo $this->getRssLink() ?>" class="link-rss"><?php echo $this->__('Subscribe to RSS Feed') ?></a>
        <?php endif; ?>
        <?php if ($_img):?>
            <div class="hylete-widget fullwidth <?php echo $_alignText;?> <?php echo $_textPlacement;?> <?php echo $_inverted;?>">
                <div class="hylete-widget-title">
                    <h2><?php echo $_name;?></h2>
                </div>
                <div class="hylete-widget-img">
                    <div class="image-placeholder">
                        <picture>
                            <source srcset="<?php echo $_imageBaseUrl . $_imgMobile; ?>" media="(max-width: 768px)">
                            <source srcset="<?php echo $_imageBaseUrl . $_imgTablet ?>" media="(max-width: 992px)">
                            <img srcset="<?php echo $_imageBaseUrl . $_img;?>" alt="<?php echo $_itemTitle; ?>">
                        </picture>
                    </div>
                    <div class="description">
                        <?php echo $_description;?>
                    </div>
                </div>
            </div>
        <?php else:?>
            <h1><?php echo $_name;?></h1>
        <?php endif;?>
    </header>
</div>
<?php echo $this->getChildHtml('hylete.category.cms.above.grid') ?>
<?php echo $this->getChildHtml('enterprisecatalog.leftnav');?>
<?php echo $this->getChildHtml('nostoCategory1') ?>
<?php if($this->isContentMode()): ?>
    <?php echo $this->getCmsBlockHtml() ?>
<?php elseif($this->isMixedMode()): ?>
    <?php echo $this->getCmsBlockHtml() ?>
    <?php echo $this->getProductListHtml() ?>
<?php else: ?>
    <?php echo $this->getProductListHtml() ?>
<?php endif; ?>
<?php echo $this->getChildHtml('nostoCategory2') ?>
<?php echo $this->getChildHtml('hylete.category.cms.below.grid') ?>